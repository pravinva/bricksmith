<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Semantic Model Refresh — Fulton Hogan &times; Databricks</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,700;1,9..40,400&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }

:root {
  --navy:   #1B3A4B;
  --red:    #FF3621;
  --orange: #F47920;
  --blue:   #0D6EAD;
  --green:  #2E7D4F;
  --purple: #6B3FA0;
  --steel:  #3A6186;
  --dark:   #2D2D2D;
  --light:  #F6F7F9;
  --border: #DDE3EB;
  --muted:  #8A9BB0;
  --white:  #FFFFFF;
  --mono:   'Space Mono', monospace;
  --sans:   'DM Sans', sans-serif;
  --disp:   'Bebas Neue', sans-serif;
  --sh-sm:  0 2px 8px rgba(0,0,0,0.07);
  --sh-md:  0 4px 20px rgba(0,0,0,0.09);
  --sh-lg:  0 8px 32px rgba(0,0,0,0.13);
}

body { font-family: var(--sans); background: var(--navy); color: var(--dark); line-height: 1; }

/* NAV */
nav {
  position: fixed; top: 0; left: 0; right: 0; z-index: 500;
  height: 52px; display: flex; align-items: stretch;
  background: rgba(27,58,75,0.97); backdrop-filter: blur(14px);
  border-bottom: 2px solid var(--orange); overflow-x: auto; overflow-y: hidden;
}
nav::-webkit-scrollbar { height: 0; }
.nav-brand {
  flex-shrink: 0; display: flex; align-items: center; gap: 11px;
  padding: 0 20px; border-right: 1px solid rgba(255,255,255,0.07);
}
.brand-mark {
  width: 31px; height: 31px; border-radius: 50%; background: var(--orange);
  display: flex; align-items: center; justify-content: center;
  font-family: var(--disp); font-size: 13px; color: var(--white); letter-spacing: 1px;
}
.brand-text { font-size: 10px; font-weight: 600; letter-spacing: 1.5px; color: rgba(255,255,255,0.45); white-space: nowrap; }
.nav-items { display: flex; align-items: stretch; }
.nav-a {
  display: flex; align-items: center; padding: 0 17px; white-space: nowrap;
  font-family: var(--sans); font-size: 10.5px; font-weight: 700; letter-spacing: 0.7px;
  color: rgba(255,255,255,0.42); text-decoration: none;
  border-bottom: 3px solid transparent; margin-top: 2px;
  transition: color 0.14s, border-color 0.14s, background 0.14s;
}
.nav-a:hover { color: rgba(255,255,255,0.82); background: rgba(255,255,255,0.04); }
.nav-a.active { color: var(--orange); border-bottom-color: var(--orange); }

/* LAYOUT */
section { min-height: 100vh; padding: 90px 0 72px; }
.wrap { max-width: 1076px; margin: 0 auto; padding: 0 34px; }

/* HERO */
#hero { background: var(--navy); display: flex; align-items: center; position: relative; overflow: hidden; }
.hero-bar-l { position: absolute; left: 0; top: 0; bottom: 0; width: 8px; background: var(--red); }
.hero-bar-b { position: absolute; left: 0; right: 0; bottom: 0; height: 5px; background: var(--orange); }
.hero-inner {
  display: grid; grid-template-columns: 1fr 140px; gap: 56px; align-items: center;
  padding: 0 52px; width: 100%; max-width: 1076px; margin: 0 auto;
}
.hero-eye { font-size: 10px; font-weight: 700; letter-spacing: 3.5px; color: var(--orange); margin-bottom: 20px; }
.hero-h {
  font-family: var(--disp); font-size: clamp(68px, 9.5vw, 112px);
  line-height: 0.91; color: var(--white); margin-bottom: 28px; letter-spacing: 1px;
}
.hero-h em { color: var(--orange); font-style: normal; }
.hero-p { font-size: 15px; font-weight: 300; line-height: 1.72; color: rgba(255,255,255,0.52); max-width: 500px; margin-bottom: 34px; }
.hero-badge {
  display: inline-flex; align-items: center;
  padding: 9px 18px; border: 1px solid rgba(244,121,32,0.38); background: rgba(244,121,32,0.07);
  font-size: 10px; font-weight: 700; letter-spacing: 1.8px; color: var(--orange);
}
.hero-mark {
  width: 118px; height: 118px; border-radius: 50%; background: var(--orange);
  display: flex; align-items: center; justify-content: center;
  font-family: var(--disp); font-size: 48px; color: var(--white); letter-spacing: 4px;
}

/* SECTION HEADER */
.sh {
  background: var(--navy); padding: 34px 34px 28px; margin-bottom: 30px;
  border-left: 6px solid var(--orange); position: relative;
}
.sh::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 3px; background: var(--orange); }
.sh-tag { font-size: 9.5px; font-weight: 700; letter-spacing: 3px; color: var(--orange); margin-bottom: 10px; }
.sh-title { font-family: var(--disp); font-size: clamp(34px, 5vw, 54px); line-height: 1; color: var(--white); }
.sh-sub { font-size: 13px; font-weight: 300; line-height: 1.65; color: rgba(255,255,255,0.48); margin-top: 10px; }
.sh-sub code { font-family: var(--mono); font-size: 11.5px; color: var(--orange); }

/* SECTION BGS */
#current-state { background: var(--light); }
#gaps          { background: var(--white); }
#principles    { background: var(--light); }
#schema        { background: var(--white); }
#workflows     { background: var(--light); }
#triggers      { background: var(--white); }
#monitoring    { background: var(--light); }
#rollout       { background: var(--white); }

/* GRIDS */
.g2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
.g3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
.g4 { display: grid; grid-template-columns: repeat(4,1fr); gap: 16px; }

/* CARDS */
.card { background: var(--white); box-shadow: var(--sh-md); transition: transform 0.18s, box-shadow 0.18s; }
.card:hover { transform: translateY(-2px); box-shadow: var(--sh-lg); }
.card-top { height: 5px; }
.card-bd { padding: 24px 26px; }

/* PROBLEM CARDS */
.prob-n { font-family: var(--disp); font-size: 50px; line-height: 1; margin-bottom: 14px; }
.prob-t { font-size: 15px; font-weight: 700; color: var(--navy); margin-bottom: 10px; line-height: 1.35; }
.prob-l { font-size: 13px; line-height: 1.72; color: var(--dark); padding-left: 16px; }
.prob-l li { margin-bottom: 7px; }

/* GAP ROWS */
.gap-row { background: var(--white); display: flex; overflow: hidden; box-shadow: var(--sh-sm); margin-bottom: 14px; }
.gap-row:last-child { margin-bottom: 0; }
.gap-stripe { width: 6px; flex-shrink: 0; }
.gap-n { padding: 22px 20px; font-family: var(--disp); font-size: 50px; line-height: 1; flex-shrink: 0; }
.gap-c { padding: 22px 20px 22px 0; }
.gap-t { font-size: 16px; font-weight: 700; color: var(--navy); margin-bottom: 7px; }
.gap-p { font-size: 13px; line-height: 1.68; color: var(--dark); }

/* OUTCOME */
.outcome { border: 1.5px solid var(--orange); background: #FFF5EE; padding: 18px 22px; margin-top: 22px; }
.outcome-lbl { font-size: 9.5px; font-weight: 700; letter-spacing: 2.5px; color: var(--orange); margin-bottom: 8px; }
.outcome-p { font-size: 13px; line-height: 1.68; color: var(--dark); }

/* INFOBAR */
.info { background: var(--navy); padding: 16px 22px; margin-top: 22px; border-left: 4px solid var(--orange); font-size: 13px; line-height: 1.65; color: rgba(255,255,255,0.78); }
.info strong { color: var(--orange); font-weight: 700; }

/* PRINCIPLES */
.prin { background: var(--white); box-shadow: var(--sh-sm); overflow: hidden; transition: transform 0.18s, box-shadow 0.18s; }
.prin:hover { transform: translateY(-2px); box-shadow: var(--sh-md); }
.prin-top { height: 4px; }
.prin-bd { padding: 20px 22px; }
.prin-n { width: 27px; height: 27px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-family: var(--mono); font-size: 11px; font-weight: 700; color: var(--white); margin-bottom: 12px; }
.prin-t { font-size: 13px; font-weight: 700; color: var(--navy); margin-bottom: 8px; line-height: 1.35; }
.prin-p { font-size: 12px; line-height: 1.68; color: var(--dark); }
.prin-p code { font-family: var(--mono); font-size: 10.5px; background: #F0F2F5; padding: 1px 5px; }

/* SCHEMA */
.sch { background: var(--white); box-shadow: var(--sh-md); overflow: hidden; }
.sch-hd { padding: 14px 20px; }
.sch-title { font-family: var(--mono); font-size: 12.5px; font-weight: 700; color: var(--white); }
.sch-sub { font-size: 11px; color: rgba(255,255,255,0.52); margin-top: 3px; font-style: italic; }
.sch-bd { padding: 14px 20px; }
.sf { display: flex; align-items: flex-start; gap: 10px; padding: 7px 0; border-bottom: 1px solid #F2F4F7; }
.sf:last-child { border-bottom: none; }
.sf-d { width: 5px; height: 5px; border-radius: 50%; flex-shrink: 0; margin-top: 5px; }
.sf-n { font-family: var(--mono); font-size: 11px; font-weight: 700; color: var(--navy); min-width: 174px; flex-shrink: 0; }
.sf-x { font-size: 11.5px; color: var(--muted); line-height: 1.42; }

/* OPTIONS */
.opts { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px; }
.opt { background: var(--white); box-shadow: var(--sh-sm); overflow: hidden; }
.opt-hd { padding: 13px 18px; border-bottom: 1px solid var(--border); }
.opt-tag { font-size: 11.5px; font-weight: 700; }
.opt-sub { font-size: 11px; font-weight: 400; margin-top: 2px; }
.opt-bd { padding: 18px; font-family: var(--mono); font-size: 10.5px; line-height: 1.88; color: var(--dark); }
.opt-verd { display: flex; align-items: flex-start; gap: 10px; padding: 12px 18px; border-top: 1px solid #EEF1F5; font-size: 12px; line-height: 1.55; color: var(--dark); }
.opt-icon { font-size: 11px; font-weight: 800; flex-shrink: 0; margin-top: 1px; }
.opt-dim { opacity: 0.62; }
.chosen { border: 1.5px solid var(--green); }
.chosen-lbl { display: inline-block; font-size: 9px; font-weight: 700; letter-spacing: 1.5px; padding: 2px 8px; margin-left: 8px; vertical-align: middle; background: var(--green); color: var(--white); }

/* CODE */
.code-lbl { font-size: 9.5px; font-weight: 700; letter-spacing: 1.5px; color: var(--muted); margin-bottom: 10px; }
.code { background: #0D1117; padding: 18px 22px; border: 1px solid #21262D; overflow-x: auto; font-family: var(--mono); font-size: 10.5px; line-height: 1.88; }
.cc  { color: #6E7681; } .ck { color: #79C0FF; } .cv { color: #A5D6FF; }
.cs  { color: #A5D6FF; } .cw { color: #FF7B72; } .ct { color: #E6EDF3; }
.chi { color: #3FB950; font-weight: 700; }

/* TASK FLOW */
.tf { display: flex; flex-direction: column; }
.tf-row { display: flex; gap: 16px; }
.tf-l { display: flex; flex-direction: column; align-items: center; width: 128px; flex-shrink: 0; }
.tf-badge { padding: 5px 8px; font-family: var(--mono); font-size: 9.5px; font-weight: 700; color: var(--white); text-align: center; width: 100%; }
.tf-line { width: 2px; flex: 1; min-height: 18px; background: var(--border); margin-top: 4px; }
.tf-c { flex: 1; background: var(--white); border-left: 4px solid; padding: 14px 18px; margin-bottom: 12px; box-shadow: var(--sh-sm); }
.tf-n { font-size: 14px; font-weight: 700; color: var(--navy); margin-bottom: 4px; }
.tf-s { font-family: var(--mono); font-size: 9.5px; color: var(--muted); line-height: 1.72; }

/* BENEFIT TILES */
.ben { background: var(--white); border: 1px solid var(--green); padding: 16px 18px; box-shadow: var(--sh-sm); }
.ben-t { font-size: 12px; font-weight: 700; color: var(--green); margin-bottom: 6px; }
.ben-p { font-size: 11.5px; color: var(--dark); line-height: 1.55; }

/* DIVIDER */
.div { height: 1px; background: var(--border); margin: 26px 0; }

/* METRICS */
.met { background: var(--white); border-top: 4px solid; padding: 20px 22px; box-shadow: var(--sh-sm); }
.met-n { font-size: 13px; font-weight: 700; color: var(--navy); margin-bottom: 5px; }
.met-s { font-size: 11.5px; color: var(--muted); line-height: 1.42; }

/* HEALTH */
.hlth { background: var(--white); box-shadow: var(--sh-md); overflow: hidden; }
.hlth-hd { padding: 13px 18px; font-size: 13px; font-weight: 700; color: var(--white); }
.hlth-bd { padding: 8px 18px 16px; }
.h-row { display: flex; align-items: center; gap: 12px; padding: 10px 0; border-bottom: 1px solid #F2F4F7; }
.h-row:last-child { border-bottom: none; }
.h-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
.h-lbl { font-size: 12.5px; font-weight: 700; width: 68px; flex-shrink: 0; }
.h-rule { font-size: 12px; color: var(--muted); line-height: 1.4; }
.w-row { display: flex; align-items: center; gap: 14px; padding: 12px 0; border-bottom: 1px solid #F2F4F7; }
.w-row:last-child { border-bottom: none; }
.w-pill { display: inline-flex; align-items: center; padding: 4px 12px; font-size: 9.5px; font-weight: 700; color: var(--white); letter-spacing: 0.5px; flex-shrink: 0; }
.w-d { font-size: 13px; color: var(--dark); }

/* PHASES */
.phase { overflow: hidden; box-shadow: var(--sh-md); }
.ph-hd { padding: 22px 24px; }
.ph-tag { font-size: 9px; font-weight: 700; letter-spacing: 2.5px; color: rgba(255,255,255,0.6); }
.ph-time { font-size: 10px; color: rgba(255,255,255,0.48); float: right; margin-top: -16px; }
.ph-title { font-family: var(--disp); font-size: 32px; color: var(--white); margin-top: 4px; }
.ph-bd { background: var(--white); padding: 20px 24px; }
.ph-item { display: flex; gap: 10px; margin-bottom: 10px; font-size: 12.5px; color: var(--dark); line-height: 1.5; }
.ph-dot { width: 5px; height: 5px; border-radius: 50%; flex-shrink: 0; margin-top: 5px; }

/* CHECKLIST */
.chk { background: var(--white); border: 1.5px solid var(--navy); box-shadow: var(--sh-md); overflow: hidden; }
.chk-hd { background: var(--navy); padding: 14px 24px; font-size: 13px; font-weight: 700; color: var(--white); }
.chk-bd { padding: 20px 24px; display: grid; grid-template-columns: 1fr 1fr; gap: 0 40px; }
.ci { display: flex; align-items: flex-start; gap: 12px; padding: 10px 0; border-bottom: 1px dashed #EEF1F5; font-size: 12.5px; color: var(--dark); line-height: 1.48; }
.ci:last-child { border-bottom: none; }
.ci-box {
  width: 16px; height: 16px; border: 1.5px solid var(--navy); flex-shrink: 0;
  margin-top: 2px; cursor: pointer; display: flex; align-items: center; justify-content: center;
  transition: background 0.14s, border-color 0.14s; user-select: none;
}
.ci-box.checked { background: var(--green); border-color: var(--green); }
.ci-box.checked::after { content: 'x'; font-family: var(--mono); font-size: 9px; font-weight: 700; color: var(--white); }

/* FOOTER */
footer { background: #111F2B; border-top: 3px solid var(--orange); padding: 30px 34px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
.f-n { font-family: var(--disp); font-size: 19px; color: var(--orange); letter-spacing: 2px; }
.f-m { font-size: 11px; color: rgba(255,255,255,0.32); }

/* REVEAL */
.rev { opacity: 0; transform: translateY(16px); transition: opacity 0.46s ease, transform 0.46s ease; }
.rev.in { opacity: 1; transform: translateY(0); }

/* RESPONSIVE */
@media (max-width: 840px) {
  .hero-inner { grid-template-columns: 1fr; }
  .hero-mark  { display: none; }
  .g2, .g3, .g4, .opts { grid-template-columns: 1fr; }
  .chk-bd { grid-template-columns: 1fr; }
  .tf-l { width: 100%; flex-direction: row; align-items: center; gap: 10px; }
  .tf-line { display: none; }
  .sf-n { min-width: 130px; }
}
</style>
</head>
<body>

<nav>
  <div class="nav-brand">
    <div class="brand-mark">FH</div>
    <div class="brand-text">DATABRICKS &times; EDP</div>
  </div>
  <div class="nav-items">
    <a class="nav-a" href="#hero">OVERVIEW</a>
    <a class="nav-a" href="#current-state">PROBLEM</a>
    <a class="nav-a" href="#gaps">GAPS</a>
    <a class="nav-a" href="#principles">DESIGN</a>
    <a class="nav-a" href="#schema">SCHEMA</a>
    <a class="nav-a" href="#workflows">WORKFLOWS</a>
    <a class="nav-a" href="#triggers">TRIGGERS</a>
    <a class="nav-a" href="#monitoring">MONITORING</a>
    <a class="nav-a" href="#rollout">ROLLOUT</a>
  </div>
</nav>

<!-- HERO -->
<section id="hero">
  <div class="hero-bar-l"></div>
  <div class="hero-bar-b"></div>
  <div class="hero-inner">
    <div>
      <div class="hero-eye">DATABRICKS &times; FULTON HOGAN &nbsp;&middot;&nbsp; ENTERPRISE DATA PLATFORM</div>
      <div class="hero-h">SEMANTIC<br>MODEL<br><em>REFRESH</em></div>
      <p class="hero-p">Production-ready, field-validated architecture for SLA-driven data freshness across 7+ semantic models in the Enterprise Data Platform.</p>
      <div class="hero-badge">FEBRUARY 2026 &nbsp;&middot;&nbsp; v2.0 VALIDATED DESIGN</div>
    </div>
    <div class="hero-mark">FH</div>
  </div>
</section>

<!-- CURRENT STATE -->
<section id="current-state">
  <div class="wrap">
    <div class="sh rev" style="border-left-color:var(--red);">
      <div class="sh-tag">01 &nbsp;/&nbsp; PROBLEM STATEMENT</div>
      <div class="sh-title">Current State &amp;<br>Business Impact</div>
      <div class="sh-sub">EDP supports 7+ semantic models across AWM, Finance, Operations and more &mdash; each with different freshness expectations and business criticality.</div>
    </div>
    <div class="g3 rev">
      <div class="card">
        <div class="card-top" style="background:var(--red)"></div>
        <div class="card-bd">
          <div class="prob-n" style="color:var(--red)">01</div>
          <div class="prob-t">Inconsistent Freshness</div>
          <ul class="prob-l">
            <li>Same Gold tables appear across models with no standardised refresh behaviour</li>
            <li>Business users cannot determine which version of a report reflects current data</li>
          </ul>
        </div>
      </div>
      <div class="card">
        <div class="card-top" style="background:var(--orange)"></div>
        <div class="card-bd">
          <div class="prob-n" style="color:var(--orange)">02</div>
          <div class="prob-t">Mismatched Cadence vs Need</div>
          <ul class="prob-l">
            <li>Low-change tables refreshed too frequently &mdash; wasting compute and increasing cost</li>
            <li>Near-real-time tables such as Dispatch may lag, directly impacting operational decisions</li>
          </ul>
        </div>
      </div>
      <div class="card">
        <div class="card-top" style="background:var(--blue)"></div>
        <div class="card-bd">
          <div class="prob-n" style="color:var(--blue)">03</div>
          <div class="prob-t">Tight Coupling, No Isolation</div>
          <ul class="prob-l">
            <li>Refresh logic must live at the platform level, not inside individual semantic models</li>
            <li>Without isolation, a failure in one model cascades and blocks all others in a shared job</li>
          </ul>
        </div>
      </div>
    </div>
    <div class="outcome rev">
      <div class="outcome-lbl">OUTCOME</div>
      <div class="outcome-p">Operational noise from failed and late refreshes &nbsp;&middot;&nbsp; Trust risk in reporting &mdash; which dashboard reflects current data? &nbsp;&middot;&nbsp; Rising platform costs from over-refreshing low-change data and failures without isolation.</div>
    </div>
  </div>
</section>

<!-- GAPS -->
<section id="gaps">
  <div class="wrap">
    <div class="sh rev" style="border-left-color:var(--red);">
      <div class="sh-tag">02 &nbsp;/&nbsp; ROOT CAUSE</div>
      <div class="sh-title">Platform-Level<br>Gaps &amp; Risks</div>
    </div>
    <div class="rev">
      <div class="gap-row">
        <div class="gap-stripe" style="background:var(--red)"></div>
        <div class="gap-n" style="color:var(--red)">01</div>
        <div class="gap-c">
          <div class="gap-t">No Centralised Refresh Design</div>
          <div class="gap-p">No single place classifies tables into NRT / Medium / Daily / On-Demand or enforces SLA expectations consistently. Without a centralised framework, every model manages its own rules independently and drift is inevitable.</div>
        </div>
      </div>
      <div class="gap-row">
        <div class="gap-stripe" style="background:var(--orange)"></div>
        <div class="gap-n" style="color:var(--orange)">02</div>
        <div class="gap-c">
          <div class="gap-t">Monitoring and Governance Gaps</div>
          <div class="gap-p">No visibility into last refresh timestamp, duration, failure reasons or SLA compliance per model. There is no audit trail, and teams investigate manually to determine whether data loads succeeded or which model is responsible for a delay.</div>
        </div>
      </div>
      <div class="gap-row" style="margin-bottom:0;">
        <div class="gap-stripe" style="background:var(--blue)"></div>
        <div class="gap-n" style="color:var(--blue)">03</div>
        <div class="gap-c">
          <div class="gap-t">Scalability and Extensibility Risk</div>
          <div class="gap-p">As new models are added &mdash; currently 7+ and growing &mdash; refresh rules are not automatically inherited from the platform. Each onboarding requires redesigning logic in multiple places, with increasing cost and risk of inconsistency over time.</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- PRINCIPLES -->
<section id="principles">
  <div class="wrap">
    <div class="sh rev" style="border-left-color:var(--green);">
      <div class="sh-tag">03 &nbsp;/&nbsp; SOLUTION DESIGN</div>
      <div class="sh-title">Design Principles</div>
      <div class="sh-sub">Six validated principles that drive every architectural decision in this framework.</div>
    </div>
    <div class="g3 rev" style="margin-bottom:22px;">
      <div class="prin">
        <div class="prin-top" style="background:var(--red)"></div>
        <div class="prin-bd">
          <div class="prin-n" style="background:var(--red)">1</div>
          <div class="prin-t">Model-level refresh</div>
          <div class="prin-p">One Power BI refresh per model &mdash; never per table. Aligns with how Power BI actually works: datasets refresh as an atomic unit. Table-level granularity requires Premium XMLA endpoints and adds unnecessary complexity.</div>
        </div>
      </div>
      <div class="prin">
        <div class="prin-top" style="background:var(--orange)"></div>
        <div class="prin-bd">
          <div class="prin-n" style="background:var(--orange)">2</div>
          <div class="prin-t">One Workflow per model per cadence</div>
          <div class="prin-p">Separate Databricks Workflows per model and cadence: AWM-DAILY, Finance-DAILY, AWM-TABLE_TRIGGERED. Failure in one model never blocks another. Retry logic, timeouts and alerting are independently tuned per model.</div>
        </div>
      </div>
      <div class="prin">
        <div class="prin-top" style="background:var(--blue)"></div>
        <div class="prin-bd">
          <div class="prin-n" style="background:var(--blue)">3</div>
          <div class="prin-t">Native table update triggers for NRT</div>
          <div class="prin-p">Databricks native table update trigger fires when a Gold table changes &mdash; no polling, no wasted compute. Built-in debounce via <code>wait_after_last_change_seconds</code> replaces custom interval logic entirely.</div>
        </div>
      </div>
      <div class="prin">
        <div class="prin-top" style="background:var(--green)"></div>
        <div class="prin-bd">
          <div class="prin-n" style="background:var(--green)">4</div>
          <div class="prin-t">SLAs as data, not code</div>
          <div class="prin-p"><code>sla_threshold_minutes</code> lives in the Unity Catalog metadata table. Changing a threshold is a SQL UPDATE &mdash; no code deployment, no pipeline change. Delta history provides a full audit trail of every SLA adjustment.</div>
        </div>
      </div>
      <div class="prin">
        <div class="prin-top" style="background:var(--purple)"></div>
        <div class="prin-bd">
          <div class="prin-n" style="background:var(--purple)">5</div>
          <div class="prin-t">Power BI task &mdash; primary integration</div>
          <div class="prin-p">The native Databricks Power BI task type handles standard refreshes without custom auth code. The REST API is available as a fallback for edge cases only: cross-workspace batch operations and complex conditional logic.</div>
        </div>
      </div>
      <div class="prin">
        <div class="prin-top" style="background:var(--steel)"></div>
        <div class="prin-bd">
          <div class="prin-n" style="background:var(--steel)">6</div>
          <div class="prin-t">Cost and freshness tracking built in</div>
          <div class="prin-p">Every refresh execution writes duration, status, warehouse DBU consumed and SLA breach flags to Unity Catalog Delta tables from day one. Observability is a first-class design requirement &mdash; not an afterthought.</div>
        </div>
      </div>
    </div>
    <div class="info rev">
      <strong>Guiding principle:</strong> Databricks owns table-level data freshness and orchestration. Semantic models own shaping, measures and serving.
    </div>
  </div>
</section>

<!-- SCHEMA -->
<section id="schema">
  <div class="wrap">
    <div class="sh rev" style="border-left-color:var(--red);">
      <div class="sh-tag">04 &nbsp;/&nbsp; TECHNICAL &mdash; METADATA</div>
      <div class="sh-title">Unity Catalog<br>Metadata Schema</div>
      <div class="sh-sub">All refresh behaviour is configuration, not code. Four Delta tables in <code>edp_metadata.semantic_refresh</code> drive the entire framework.</div>
    </div>
    <div class="g2 rev" style="margin-bottom:20px;">

      <div class="sch">
        <div class="sch-hd" style="background:var(--red);"><div class="sch-title">semantic_models</div><div class="sch-sub">Registry of all Power BI semantic models</div></div>
        <div class="sch-bd">
          <div class="sf"><div class="sf-d" style="background:var(--red)"></div><div><span class="sf-n">model_id, model_name</span><div class="sf-x">Unique identifier and display name for the model</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--red)"></div><div><span class="sf-n">workspace_id, dataset_id</span><div class="sf-x">Power BI GUIDs required for task and API calls</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--red)"></div><div><span class="sf-n">connection_name</span><div class="sf-x">UC Power BI connection, e.g. edp_powerbi.awm_workspace</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--red)"></div><div><span class="sf-n">query_mode</span><div class="sf-x">Import / DirectQuery / Dual / Hybrid &mdash; drives refresh behaviour</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--red)"></div><div><span class="sf-n">sla_tier</span><div class="sf-x">T0 = critical, T1 = important, T2 = standard &mdash; controls alert priority</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--red)"></div><div><span class="sf-n">auth_mode, owner_email</span><div class="sf-x">SERVICE_PRINCIPAL / OAUTH / PAT &mdash; and operational contact</div></div></div>
        </div>
      </div>

      <div class="sch">
        <div class="sch-hd" style="background:var(--orange);"><div class="sch-title">table_refresh_config</div><div class="sch-sub">Per-table cadence and trigger rules</div></div>
        <div class="sch-bd">
          <div class="sf"><div class="sf-d" style="background:var(--orange)"></div><div><span class="sf-n">config_id, model_id</span><div class="sf-x">Primary key and FK to semantic_models</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--orange)"></div><div><span class="sf-n">source_table</span><div class="sf-x">Fully qualified UC table: catalog.schema.table</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--orange)"></div><div><span class="sf-n">refresh_cadence</span><div class="sf-x">NEAR_REALTIME / MEDIUM_FREQUENCY / DAILY / ON_DEMAND</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--orange)"></div><div><span class="sf-n">trigger_mode</span><div class="sf-x">SCHEDULE / TABLE_UPDATE / PIPELINE_COMPLETE / MANUAL</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--orange)"></div><div><span class="sf-n">sla_threshold_minutes</span><div class="sf-x">Max minutes before breach &mdash; data-driven, SQL-updateable</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--orange)"></div><div><span class="sf-n">refresh_type, is_active</span><div class="sf-x">FULL / INCREMENTAL &mdash; and enable/disable flag per table</div></div></div>
        </div>
      </div>

      <div class="sch">
        <div class="sch-hd" style="background:var(--blue);"><div class="sch-title">refresh_execution_log</div><div class="sch-sub">Audit log of every refresh run</div></div>
        <div class="sch-bd">
          <div class="sf"><div class="sf-d" style="background:var(--blue)"></div><div><span class="sf-n">execution_id, model_id</span><div class="sf-x">Unique run identifier and FK to semantic_models</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--blue)"></div><div><span class="sf-n">workflow_run_id</span><div class="sf-x">Databricks job run ID for end-to-end tracing</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--blue)"></div><div><span class="sf-n">powerbi_refresh_id</span><div class="sf-x">Power BI API response ID for cross-service correlation</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--blue)"></div><div><span class="sf-n">status</span><div class="sf-x">RUNNING / SUCCESS / FAILED / TIMEOUT</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--blue)"></div><div><span class="sf-n">duration_seconds, rows_processed</span><div class="sf-x">Performance metrics per run for health scoring</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--blue)"></div><div><span class="sf-n">triggered_by, error_message</span><div class="sf-x">Trigger source and error detail for incident triage</div></div></div>
        </div>
      </div>

      <div class="sch">
        <div class="sch-hd" style="background:var(--green);"><div class="sch-title">refresh_cost_tracking</div><div class="sch-sub">DBU and USD cost per refresh run</div></div>
        <div class="sch-bd">
          <div class="sf"><div class="sf-d" style="background:var(--green)"></div><div><span class="sf-n">cost_id, execution_id</span><div class="sf-x">FK to refresh_execution_log</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--green)"></div><div><span class="sf-n">warehouse_id, warehouse_name</span><div class="sf-x">SQL warehouse that served the refresh request</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--green)"></div><div><span class="sf-n">compute_units_consumed</span><div class="sf-x">DBU consumed per run &mdash; source for FinOps reporting</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--green)"></div><div><span class="sf-n">warehouse_cost_estimate_usd</span><div class="sf-x">Estimated cost in USD per refresh execution</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--green)"></div><div><span class="sf-n">query_count, data_transfer_gb</span><div class="sf-x">Query-level metrics for transfer volume to Power BI</div></div></div>
          <div class="sf"><div class="sf-d" style="background:var(--green)"></div><div><span class="sf-n">compute / storage / network split</span><div class="sf-x">Cost breakdown for detailed FinOps attribution</div></div></div>
        </div>
      </div>

    </div>
    <div class="info rev">
      All four tables have <strong>Delta Change Data Feed enabled</strong> &mdash; full audit history of every config change, refresh run and cost entry. The execution log is <strong>partitioned by date</strong> for efficient time-range querying. Log retention: 90 days.
    </div>
  </div>
</section>

<!-- WORKFLOWS -->
<section id="workflows">
  <div class="wrap">
    <div class="sh rev" style="border-left-color:var(--orange);">
      <div class="sh-tag">05 &nbsp;/&nbsp; TECHNICAL &mdash; ORCHESTRATION</div>
      <div class="sh-title">Model-Based<br>Workflow Architecture</div>
      <div class="sh-sub">One Databricks Workflow per model per cadence &mdash; complete failure isolation and independent operational control per model.</div>
    </div>

    <div class="opts rev">
      <div class="opt opt-dim">
        <div class="opt-hd" style="background:rgba(139,155,176,0.1);border-bottom:1px solid var(--border);">
          <div class="opt-tag" style="color:var(--muted);">OPTION A &mdash; CONSIDERED &nbsp;<span style="font-size:9px;font-weight:400;">Not selected</span></div>
          <div class="opt-sub" style="color:var(--muted);">Cadence-based shared jobs</div>
        </div>
        <div class="opt-bd" style="color:var(--muted);">
          Workflow: "Daily Refresh"<br>
          &nbsp;&nbsp;├── AWM &nbsp;&nbsp;&nbsp;(3 tables)<br>
          &nbsp;&nbsp;├── Finance &nbsp;(5 tables)<br>
          &nbsp;&nbsp;└── Operations (4 tables)
        </div>
        <div class="opt-verd">
          <span class="opt-icon" style="color:var(--red);">&mdash;</span>
          <div>A Finance failure blocks AWM and Operations. SLA ownership is unclear. Retry and timeout settings are shared. Difficult to isolate which model caused an incident or to tune behaviour per model.</div>
        </div>
      </div>
      <div class="opt chosen">
        <div class="opt-hd" style="background:rgba(46,125,79,0.07);border-bottom:1px solid rgba(46,125,79,0.2);">
          <div class="opt-tag" style="color:var(--green);">OPTION B &mdash; SELECTED<span class="chosen-lbl">CHOSEN</span></div>
          <div class="opt-sub" style="color:var(--green);">Model-based isolated jobs</div>
        </div>
        <div class="opt-bd">
          <span class="chi">AWM-DAILY</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cron 06:00 NZT)<br>
          <span class="chi">AWM-MEDIUM_FREQUENCY</span>&nbsp;&nbsp;(every 4h)<br>
          <span class="chi">AWM-TABLE_TRIGGERED</span>&nbsp;&nbsp;&nbsp;(on gold.awm.fact_dispatch)<br>
          <span class="chi">Finance-DAILY</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(cron 06:00 NZT)<br>
          <span class="chi">Finance-MEDIUM_FREQUENCY</span>(every 4h)
        </div>
        <div class="opt-verd">
          <span class="opt-icon" style="color:var(--green);">+</span>
          <div>Complete failure isolation &mdash; a Finance issue never blocks AWM. Each model has independent retry count, timeout and alerting configuration. Onboarding a new model generates one new workflow with no changes to existing jobs.</div>
        </div>
      </div>
    </div>

    <div class="g2 rev">
      <div>
        <div class="code-lbl" style="margin-bottom:12px;">TASK SEQUENCE &mdash; EACH MODEL WORKFLOW</div>
        <div class="tf">
          <div class="tf-row">
            <div class="tf-l"><div class="tf-badge" style="background:var(--blue);">log_start</div><div class="tf-line"></div></div>
            <div class="tf-c" style="border-left-color:var(--blue);">
              <div class="tf-n">log_model_refresh</div>
              <div class="tf-s">event=REFRESH_START<br>model_id, tables, trigger_type</div>
            </div>
          </div>
          <div class="tf-row">
            <div class="tf-l"><div class="tf-badge" style="background:var(--green);">refresh_model</div><div class="tf-line"></div></div>
            <div class="tf-c" style="border-left-color:var(--green);">
              <div class="tf-n">power_bi_task &mdash; primary</div>
              <div class="tf-s">connection_name, dataset_id<br>refresh_type=full<br>refreshes ALL tables in model atomically</div>
            </div>
          </div>
          <div class="tf-row">
            <div class="tf-l"><div class="tf-badge" style="background:var(--blue);">log_complete</div><div class="tf-line"></div></div>
            <div class="tf-c" style="border-left-color:var(--blue);">
              <div class="tf-n">log_model_refresh</div>
              <div class="tf-s">event=REFRESH_COMPLETE<br>duration_seconds, status, rows_processed</div>
            </div>
          </div>
          <div class="tf-row">
            <div class="tf-l"><div class="tf-badge" style="background:var(--purple);">capture_costs</div></div>
            <div class="tf-c" style="border-left-color:var(--purple);">
              <div class="tf-n">capture_refresh_costs</div>
              <div class="tf-s">warehouse_id, DBU, cost_usd<br>query_count, data_transfer_gb</div>
            </div>
          </div>
        </div>
        <div style="border:1px solid var(--orange);background:#FFF5EE;padding:10px 14px;margin-top:8px;font-size:11.5px;color:var(--orange);font-family:var(--mono);">
          on_failure &rarr; owner_email + data.platform@fultonhogan.com
        </div>
      </div>

      <div>
        <div class="code-lbl">WORKFLOW GENERATION &mdash; PYTHON SDK</div>
        <div class="code">
<span class="cc"># 05_generate_workflows_model_based.py</span>
<span class="ct">
scheduled = spark.sql(</span><span class="cs">"""
  SELECT m.model_id, m.model_name,
         m.connection_name, m.dataset_id,
         m.sla_tier, c.refresh_cadence,
         COLLECT_LIST(c.table_name) AS tables
  FROM semantic_models m
  JOIN table_refresh_config c
    ON m.model_id = c.model_id
  WHERE m.is_active = true
    AND c.trigger_mode = 'SCHEDULE'
  GROUP BY m.model_id, c.refresh_cadence
"""</span><span class="ct">).collect()

</span><span class="cw">for</span><span class="ct"> model </span><span class="cw">in</span><span class="ct"> scheduled:
  name = </span><span class="cs">f"{model.model_name} - {model.refresh_cadence}"</span>
<span class="ct">  w.jobs.create(
    name = name,
    tasks = [{
      </span><span class="ck">"task_key"</span><span class="ct">:    </span><span class="cs">"refresh_model"</span><span class="ct">,
      </span><span class="ck">"power_bi_task"</span><span class="ct">: {
        </span><span class="ck">"connection_name"</span><span class="ct">: model.connection_name,
        </span><span class="ck">"dataset_id"</span><span class="ct">:      model.dataset_id,
        </span><span class="ck">"refresh_type"</span><span class="ct">:   </span><span class="cs">"full"</span>
<span class="ct">      }
    }],
    tags = {</span><span class="cs">"ManagedBy"</span><span class="ct">: </span><span class="cs">"MetadataFramework"</span><span class="ct">}
  )</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- TRIGGERS -->
<section id="triggers">
  <div class="wrap">
    <div class="sh rev" style="border-left-color:var(--blue);">
      <div class="sh-tag">06 &nbsp;/&nbsp; TECHNICAL &mdash; TRIGGERS</div>
      <div class="sh-title">Triggers &amp;<br>Refresh Mechanics</div>
      <div class="sh-sub">How near-real-time refresh is triggered, how the Power BI task integrates, and when the REST API fallback applies.</div>
    </div>

    <div class="opts rev">
      <div class="opt opt-dim">
        <div class="opt-hd" style="background:rgba(139,155,176,0.1);border-bottom:1px solid var(--border);">
          <div class="opt-tag" style="color:var(--muted);">OPTION A &mdash; CONSIDERED &nbsp;<span style="font-size:9px;font-weight:400;">Not selected</span></div>
          <div class="opt-sub" style="color:var(--muted);">Scheduled polling every 15 minutes</div>
        </div>
        <div class="opt-bd" style="color:var(--muted);">
          <span class="cc"># Runs on fixed schedule regardless of data changes</span><br>
          <span class="cw">for</span> table <span class="cw">in</span> near_realtime_tables:<br>
          &nbsp;&nbsp;last = spark.sql(<br>
          &nbsp;&nbsp;&nbsp;&nbsp;<span class="cs">f"DESCRIBE HISTORY {table}"</span>).first()<br>
          &nbsp;&nbsp;<span class="cw">if</span> last > last_refresh:<br>
          &nbsp;&nbsp;&nbsp;&nbsp;trigger_refresh()
        </div>
        <div class="opt-verd">
          <span class="opt-icon" style="color:var(--red);">&mdash;</span>
          <div>Compute runs every 15 minutes whether or not data has changed. Polling interval creates artificial latency. Requires maintaining custom notebook logic and table history tracking.</div>
        </div>
      </div>

      <div class="opt chosen">
        <div class="opt-hd" style="background:rgba(46,125,79,0.07);border-bottom:1px solid rgba(46,125,79,0.2);">
          <div class="opt-tag" style="color:var(--green);">OPTION B &mdash; SELECTED<span class="chosen-lbl">CHOSEN</span></div>
          <div class="opt-sub" style="color:var(--green);">Native Databricks table update trigger</div>
        </div>
        <div class="opt-bd">
          <span class="cs">"trigger"</span>: {<br>
          &nbsp;&nbsp;<span class="cs">"table_update"</span>: {<br>
          &nbsp;&nbsp;&nbsp;&nbsp;<span class="ck">"table_names"</span>: [<span class="cs">"gold.awm.fact_dispatch"</span>],<br>
          &nbsp;&nbsp;&nbsp;&nbsp;<span class="ck">"condition"</span>: <span class="cs">"ANY_UPDATE"</span>,<br>
          &nbsp;&nbsp;&nbsp;&nbsp;<span class="chi">"wait_after_last_change_seconds"</span>: <span class="chi">1800</span><br>
          &nbsp;&nbsp;}<br>
          }
        </div>
        <div class="opt-verd">
          <span class="opt-icon" style="color:var(--green);">+</span>
          <div>Fires only when Gold table actually changes. Zero polling compute. Built-in 30-minute debounce enforces the minimum refresh interval. Native Databricks feature &mdash; no custom code to maintain.</div>
        </div>
      </div>
    </div>

    <div class="g4 rev" style="margin-bottom:26px;">
      <div class="ben"><div class="ben-t">No wasted compute</div><div class="ben-p">Workflow runs only when a Gold table change is detected &mdash; never on a fixed timer</div></div>
      <div class="ben"><div class="ben-t">Lower latency</div><div class="ben-p">Trigger fires immediately on change &mdash; no waiting for the next poll window to expire</div></div>
      <div class="ben"><div class="ben-t">Built-in debounce</div><div class="ben-p">wait_after_last_change_seconds enforces the minimum refresh interval natively</div></div>
      <div class="ben"><div class="ben-t">Zero custom code</div><div class="ben-p">Native Databricks feature &mdash; no polling notebook or history-tracking logic to maintain</div></div>
    </div>

    <div class="div"></div>

    <div class="g2 rev">
      <div class="card" style="border-top:4px solid var(--green);">
        <div class="card-bd">
          <div style="font-size:10px;font-weight:700;letter-spacing:1.8px;color:var(--green);margin-bottom:14px;">POWER BI TASK &mdash; PRIMARY (90% OF CASES)</div>
          <p style="font-size:13px;line-height:1.68;color:var(--dark);margin-bottom:12px;">Native Databricks task type &mdash; no custom authentication code required. Configured directly in the Workflow task definition alongside retry, timeout and alert settings.</p>
          <ul class="prob-l">
            <li>Accepts: <code style="font-family:var(--mono);font-size:10px;background:#F0F2F5;padding:1px 5px;">connection_name</code>, <code style="font-family:var(--mono);font-size:10px;background:#F0F2F5;padding:1px 5px;">dataset_id</code>, <code style="font-family:var(--mono);font-size:10px;background:#F0F2F5;padding:1px 5px;">refresh_type: full</code></li>
            <li>Handles Import, Incremental, Scheduled and Table-triggered workflows</li>
            <li>Retry count, timeout and on_failure email configured directly on the task</li>
          </ul>
        </div>
      </div>
      <div class="card" style="border-top:4px solid var(--muted);">
        <div class="card-bd">
          <div style="font-size:10px;font-weight:700;letter-spacing:1.8px;color:var(--muted);margin-bottom:14px;">REST API FALLBACK &mdash; EDGE CASES ONLY (10%)</div>
          <div class="code" style="font-size:10px;margin-bottom:14px;padding:14px 16px;">
<span class="cw">POST</span> <span class="cs">https://api.powerbi.com/v1.0/myorg/groups/</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs">{workspaceId}/datasets/{datasetId}/refreshes</span><br>
<span class="cc">Authorization: Bearer {entra_oauth2_token}</span>
          </div>
          <ul class="prob-l">
            <li>Auth: Service Principal &rarr; Entra ID OAuth2 &rarr; Bearer token via Key Vault secret scope</li>
            <li>Use for: cross-workspace batch operations, complex conditional logic, SSO DirectQuery edge cases</li>
            <li>Not required for standard Import or Incremental refresh &mdash; the Power BI task handles those</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- MONITORING -->
<section id="monitoring">
  <div class="wrap">
    <div class="sh rev" style="border-left-color:var(--green);">
      <div class="sh-tag">07 &nbsp;/&nbsp; TECHNICAL &mdash; OBSERVABILITY</div>
      <div class="sh-title">Monitoring &amp;<br>Health Scorecard</div>
      <div class="sh-sub">Built in from Day 1. Every refresh execution writes to UC Delta tables &mdash; dashboards and alerts derive from this single source of truth.</div>
    </div>

    <div class="g2 rev" style="margin-bottom:20px;">
      <div class="hlth">
        <div class="hlth-hd" style="background:var(--green);">Health Score &mdash; 0 to 100 per model</div>
        <div class="hlth-bd">
          <div class="w-row"><div class="w-pill" style="background:var(--green);">50% weight</div><div class="w-d">Success rate over last 7 days</div></div>
          <div class="w-row"><div class="w-pill" style="background:var(--blue);">50% weight</div><div class="w-d">SLA breach count &mdash; 0 breaches = full 50 pts, &gt;5 breaches = 0 pts</div></div>
        </div>
      </div>
      <div class="hlth">
        <div class="hlth-hd" style="background:var(--navy);">Status Thresholds</div>
        <div class="hlth-bd">
          <div class="h-row"><div class="h-dot" style="background:var(--green)"></div><div class="h-lbl" style="color:var(--green);">Healthy</div><div class="h-rule">0 SLA breaches AND success rate &ge;95%</div></div>
          <div class="h-row"><div class="h-dot" style="background:#D4AC0D"></div><div class="h-lbl" style="color:#9A7800;">Warning</div><div class="h-rule">1&ndash;5 breaches OR success rate &lt;95%</div></div>
          <div class="h-row"><div class="h-dot" style="background:var(--red)"></div><div class="h-lbl" style="color:var(--red);">Critical</div><div class="h-rule">&gt;5 breaches OR model has never completed a refresh</div></div>
        </div>
      </div>
    </div>

    <div class="g4 rev" style="margin-bottom:22px;">
      <div class="met" style="border-top-color:var(--blue);"><div class="met-n">Last refresh timestamp</div><div class="met-s">Per model and per table, available in real time</div></div>
      <div class="met" style="border-top-color:var(--green);"><div class="met-n">Refresh duration</div><div class="met-s">Average, maximum and minimum in seconds</div></div>
      <div class="met" style="border-top-color:var(--orange);"><div class="met-n">SLA breach count</div><div class="met-s">7-day rolling window, flagged per model</div></div>
      <div class="met" style="border-top-color:var(--purple);"><div class="met-n">Cost per refresh</div><div class="met-s">DBU consumed and projected annual USD</div></div>
    </div>

    <div class="rev">
      <div class="code-lbl">MODEL HEALTH REPORT &mdash; SQL ANALYTICS DASHBOARD QUERY</div>
      <div class="code">
<span class="cc">-- model_health_report.sql</span>
<span class="cw">SELECT</span><span class="ct">
  model_name, sla_tier, query_mode,
  </span><span class="cw">CAST</span><span class="ct">(
    (success_rate_pct * 0.5) +
    (</span><span class="cw">CASE WHEN</span><span class="ct"> sla_breaches_7d = 0 </span><span class="cw">THEN</span><span class="ct"> 50
         </span><span class="cw">WHEN</span><span class="ct"> sla_breaches_7d &lt;= 2 </span><span class="cw">THEN</span><span class="ct"> 30
         </span><span class="cw">ELSE</span><span class="ct"> 0 </span><span class="cw">END</span><span class="ct">)
  </span><span class="cw">AS INT</span><span class="ct">)                              </span><span class="cw">AS</span><span class="ct"> health_score,
  total_refreshes_7d,
  success_rate_pct,
  sla_breaches_7d,
  avg_duration_min,
  total_cost_7d_usd,
  </span><span class="cw">ROUND</span><span class="ct">(total_cost_7d_usd * 52.0 / 7, 2) </span><span class="cw">AS</span><span class="ct"> projected_annual_cost_usd,
  last_refresh_timestamp,
  minutes_since_last_refresh,
  status                                </span><span class="cc">-- Healthy / Warning / Critical</span>
<span class="cw">FROM</span><span class="ct">  model_metrics
</span><span class="cw">ORDER BY</span><span class="ct">
  </span><span class="cw">CASE</span><span class="ct"> sla_tier
    </span><span class="cw">WHEN</span><span class="ct"> </span><span class="cs">'T0'</span><span class="ct"> </span><span class="cw">THEN</span><span class="ct"> 1
    </span><span class="cw">WHEN</span><span class="ct"> </span><span class="cs">'T1'</span><span class="ct"> </span><span class="cw">THEN</span><span class="ct"> 2
    </span><span class="cw">ELSE</span><span class="ct"> 3
  </span><span class="cw">END</span><span class="ct">,
  health_score </span><span class="cw">ASC</span><span class="ct">;</span>
      </div>
    </div>
  </div>
</section>

<!-- POWER BI TASK DIAGRAM -->
<section id="powerbi-task-diagram">
  <div class="wrap">
    <div class="sh rev" style="border-left-color:var(--blue);">
      <div class="sh-tag">07A &nbsp;/&nbsp; REFERENCE DIAGRAM</div>
      <div class="sh-title">Power BI Task in Databricks<br>Reference Architecture</div>
      <div class="sh-sub">Native workflow-driven dataset refresh using Unity Catalog connection governance and built-in execution monitoring.</div>
    </div>

    <div class="card rev" style="padding:14px;">
      <a href="https://pravinva.github.io/bricksmith/FH_Semantic_Refresh_immersive.html" target="_blank" rel="noopener noreferrer">
        <img src="./PowerBI_Task_Databricks_Reference_Architecture.png" alt="Power BI Task in Databricks reference architecture diagram" style="display:block;width:100%;height:auto;border-radius:10px;border:1px solid #D8DEE8;">
      </a>
      <div style="margin-top:10px;font-size:12px;color:#5F6B7B;">
        Click the diagram to open the published immersive page:
        <a href="https://pravinva.github.io/bricksmith/FH_Semantic_Refresh_immersive.html" target="_blank" rel="noopener noreferrer">pravinva.github.io/bricksmith/FH_Semantic_Refresh_immersive.html</a>
      </div>
    </div>
  </div>
</section>

<!-- ROLLOUT -->
<section id="rollout">
  <div class="wrap">
    <div class="sh rev" style="border-left-color:var(--red);">
      <div class="sh-tag">08 &nbsp;/&nbsp; DEPLOYMENT</div>
      <div class="sh-title">Rollout Plan &amp;<br>Deployment Checklist</div>
    </div>

    <div class="g3 rev" style="margin-bottom:24px;">
      <div class="phase">
        <div class="ph-hd" style="background:var(--orange);">
          <div class="ph-tag">PHASE 1</div><div class="ph-time">Weeks 1&ndash;2</div>
          <div class="ph-title">Pilot</div>
        </div>
        <div class="ph-bd">
          <div class="ph-item"><div class="ph-dot" style="background:var(--orange)"></div><div>Stand up metadata schema in edp_metadata.semantic_refresh</div></div>
          <div class="ph-item"><div class="ph-dot" style="background:var(--orange)"></div><div>Seed one daily and one four-hourly model (AWM) with full config</div></div>
          <div class="ph-item"><div class="ph-dot" style="background:var(--orange)"></div><div>Generate model-based workflows via 05_generate_workflows.py</div></div>
          <div class="ph-item"><div class="ph-dot" style="background:var(--orange)"></div><div>Validate Power BI task refresh end-to-end in non-production</div></div>
          <div class="ph-item"><div class="ph-dot" style="background:var(--orange)"></div><div>Confirm execution log and cost tracking tables are populating correctly</div></div>
        </div>
      </div>
      <div class="phase">
        <div class="ph-hd" style="background:var(--blue);">
          <div class="ph-tag">PHASE 2</div><div class="ph-time">Weeks 3&ndash;6</div>
          <div class="ph-title">Scale</div>
        </div>
        <div class="ph-bd">
          <div class="ph-item"><div class="ph-dot" style="background:var(--blue)"></div><div>Classify and seed all tables across 7+ models with cadence and SLA config</div></div>
          <div class="ph-item"><div class="ph-dot" style="background:var(--blue)"></div><div>Generate all scheduled workflows per model via the metadata-driven generator</div></div>
          <div class="ph-item"><div class="ph-dot" style="background:var(--blue)"></div><div>Build and publish the SQL Analytics health dashboard</div></div>
          <div class="ph-item"><div class="ph-dot" style="background:var(--blue)"></div><div>Configure SLA breach alerting via Teams webhook and email</div></div>
        </div>
      </div>
      <div class="phase">
        <div class="ph-hd" style="background:var(--red);">
          <div class="ph-tag">PHASE 3</div><div class="ph-time">Post go-live</div>
          <div class="ph-title">NRT</div>
        </div>
        <div class="ph-bd">
          <div class="ph-item"><div class="ph-dot" style="background:var(--red)"></div><div>Enable native table update triggers for validated NRT domains</div></div>
          <div class="ph-item"><div class="ph-dot" style="background:var(--red)"></div><div>AWM Dispatch: gold.awm.fact_dispatch with 30-minute debounce</div></div>
          <div class="ph-item"><div class="ph-dot" style="background:var(--red)"></div><div>Monitor SLA compliance and tune thresholds via metadata SQL updates</div></div>
          <div class="ph-item"><div class="ph-dot" style="background:var(--red)"></div><div>Document operational procedures and train the operations team</div></div>
        </div>
      </div>
    </div>

    <div class="chk rev">
      <div class="chk-hd">Pre-Deployment Checklist</div>
      <div class="chk-bd">
        <div class="ci"><div class="ci-box" onclick="this.classList.toggle('checked')"></div><div>Azure AD Service Principal created and added to Power BI workspaces with Contributor role</div></div>
        <div class="ci"><div class="ci-box" onclick="this.classList.toggle('checked')"></div><div>Databricks Secret scope configured, AKV-backed, with Service Principal credentials loaded</div></div>
        <div class="ci"><div class="ci-box" onclick="this.classList.toggle('checked')"></div><div>Power BI Admin portal: Service principals allowed for API access</div></div>
        <div class="ci"><div class="ci-box" onclick="this.classList.toggle('checked')"></div><div>Power BI Admin: Enhance admin APIs enabled for workspace-level operations</div></div>
        <div class="ci"><div class="ci-box" onclick="this.classList.toggle('checked')"></div><div>Unity Catalog Power BI connections created and connection test verified for each workspace</div></div>
        <div class="ci"><div class="ci-box" onclick="this.classList.toggle('checked')"></div><div>Metadata schema deployed and permissions granted to Service Principal and field engineers</div></div>
      </div>
    </div>
  </div>
</section>

<footer>
  <div class="f-n">DATABRICKS &times; FULTON HOGAN</div>
  <div class="f-m">Enterprise Data Platform &nbsp;&middot;&nbsp; Semantic Model Refresh v2.0 &nbsp;&middot;&nbsp; February 2026</div>
</footer>

<script>
(function () {
  'use strict';
  var els   = document.querySelectorAll('.rev');
  var links = document.querySelectorAll('.nav-a');
  var secs  = document.querySelectorAll('section[id]');

  /* Scroll reveal */
  var ro = new IntersectionObserver(function (entries) {
    entries.forEach(function (e, i) {
      if (e.isIntersecting) {
        setTimeout(function () { e.target.classList.add('in'); }, i * 55);
        ro.unobserve(e.target);
      }
    });
  }, { rootMargin: '0px 0px -52px 0px', threshold: 0.03 });
  els.forEach(function (el) { ro.observe(el); });

  /* Active nav */
  var ao = new IntersectionObserver(function (entries) {
    entries.forEach(function (e) {
      if (e.isIntersecting) {
        links.forEach(function (l) { l.classList.remove('active'); });
        var a = document.querySelector('.nav-a[href="#' + e.target.id + '"]');
        if (a) {
          a.classList.add('active');
          a.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
        }
      }
    });
  }, { rootMargin: '-36% 0px -60% 0px', threshold: 0 });
  secs.forEach(function (s) { ao.observe(s); });
}());
</script>
</body>
</html>
